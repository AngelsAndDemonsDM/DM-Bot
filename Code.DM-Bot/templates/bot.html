<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>Панель управления ботом</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        .container {
            display: flex;
            justify-content: space-between;
        }

        .input-column {
            flex: 1;
            margin-right: 20px;
        }

        .output-column {
            flex: 1;
        }

        .active {
            color: rgb(0, 255, 0);
        }

        .inactive {
            color: red;
        }
    </style>
</head>

<body>
    <ul>
        <li><a href="/">Главная</a></li>
        <li><a href="/bot">Управление ботом</a></li>
        <li><a href="/about">О программе</a></li>
    </ul>

    <div class="container">
        <div class="card">
            <div class="card-content">

                <h3>Панель управления ботом</h3>

                <!-- Ввод токена бота -->
                <div class="input-column">
                    <label for="botToken">Ввести токен:</label>
                    <input type="text" id="botToken">
                    <button onclick="sendToken()">Отправить</button>
                </div>

            </div>
        </div>

        <div class="card">
            <div class="card-content">
                Статус онлайна бота: <p style="display: inline;" id="botStatus"></p><br><br>
                <div class="output-column">
                    Статус ответа сервера:
                    <p id="anserFromPy"></p>
                </div>
            </div>
        </div>
    </div>

</body>

<div class="footer">
    <p>DM-Bot</p>
</div>

<script type="text/javascript">
    var socket = io.connect('http://' + document.domain + ':' + location.port);

    // Обновление статуса бота
    setInterval(statusBot, 5000); // Фактически обновление каждые 5 секунд
    
    function statusBot() {
        socket.emit('requestBotStatus');
    }

    socket.on('getBotStatus', function(data) {
        var botStatusElement = document.getElementById("botStatus");

        if (data == true) {
            botStatusElement.textContent = "Онлаин";
            botStatusElement.classList.add('active');
            botStatusElement.classList.remove('inactive'); 
        } else {
            botStatusElement.textContent = "Оффлаин";
            botStatusElement.classList.add('inactive'); 
            botStatusElement.classList.remove('active');
        }
    })

    // Настройка токена для бота
    function sendToken() {
        var botToken = document.getElementById("botToken").value;
        socket.emit('sendToken', botToken);
    }

    socket.on('anserFromPy', function(data) {
        document.getElementById("anserFromPy").textContent = data;
    });
</script>

</html>
